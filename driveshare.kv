### Custom widgets for Storj's DriveShare
<-BlockColor@Color>:
	Color:
		rgba: 1, 1, 1, 1

<-Mybar@ProgressBar>:
	canvas:
		Color:
			rgb: 1, 1, 1
		BorderImage:
			border: (2, 2, 2, 2)
			pos: self.x, self.center_y - 10
			size: self.width, 10
			source: './images/storj-progressbar_background.png'
		BorderImage:
			border: (2 if self.value > 0 else 0, 2 if self.value > 0 else 0, 2, self.width * (self.value / float(self.max)))
			pos: self.x, self.center_y - 10
			size: self.width * (self.value / float(self.max)) if self.max else 0, 10
			source: './images/storj-progressbar.png'

<-ActionButton@Button>:
	background_normal: './images/corners.png'
	background_down: './images/corners_down.png'
	border: 7, 7, 7, 7
	state_image: self.background_normal if self.state == 'normal' else self.background_down
	disabled_image: self.background_disabled_normal if self.state == 'normal' else self.background_disabled_down
	font_name: './fonts/Montserrat-Bold.ttf'
	canvas:
		Color:
			rgba: self.background_color
		BorderImage:
			border: self.border
			pos: self.pos
			size: self.size
			source: self.disabled_image if self.disabled else self.state_image
		Color:
			rgba: 1, 1, 1, 1
		Rectangle:
			texture: self.texture
			size: self.texture_size
			pos: int(self.center_x - self.texture_size[0] / 2.0), int(self.center_y - self.texture_size[1] / 2.)


<TextInput>:
	#background_normal: './images/textinput.png'
	canvas.before:
		Color:
			rgba: self.background_color
		BorderImage:
			border: self.border
			pos: self.pos
			size: self.size
			source: (self.background_disabled_active if self.disabled else self.background_active) if self.focus else (self.background_disabled_normal if self.disabled else self.background_normal)
		Color:
			rgba: (0, 0, 0, 1 if self.focus and not self.cursor_blink else 0)
		Rectangle:
			pos: [int(x) for x in self.cursor_pos]
			size: 1, -self.line_height
		Color:
			rgba: self.disabled_foreground_color if self.disabled else (self.hint_text_color if not self.text and not self.focus else self.foreground_color)


### Widgets
<MainMenu>:
	id: main_menu
	orientation: 'vertical'
	pos_hint: {'top': 1.0}
	spacing: 1
	padding: 1, 0
	canvas.before:
		Color:
			rgba: app.LIGHT_GREY
		Rectangle:
			pos: self.pos
			size: self.size

	### Title row
	BoxLayout:
		orientation: 'horizontal'
		size_hint: 1.0, 0.09
		padding: 20, 0
		canvas.before:
			BlockColor:
			Rectangle:
				pos: self.pos
				size: self.size
			Color:
				rgba: app.BLUE
			Rectangle:
				pos: 0, main_menu.height - 5
				size: self.width+2, 5
		Label:
			id: application_title_label
			pos_hint: {'top': 1}
			text: main_menu.top_row_text
			size_hint: 0.85, 1.0
			text_size: self.size
			valign: 'middle'
			font_name: './fonts/Montserrat-Bold.ttf'
			color: app.DARK_GREY
			font_size: '19sp'
		Button:
			id: application_open_storjcoin
			text: "?"
			pos_hint: {'top': 0.71}
			font_name: './fonts/DroidSansMono.ttf'
			size_hint: 0.15, 0.4
			color: app.DARK_YELLOW
			background_color: app.YELLOW
			background_normal: './images/cancel_btn.png'
			background_down: './images/cancel_btn_down.png'
			border: 9, 9, 14, 14
			on_release: main_menu.app_goto_site_callback(application_open_storjcoin)

	### Storage bar
	BoxLayout:
		orientation: 'vertical'
		size_hint: 1.0, 0.11
		padding: 20, 0
		canvas.before:
			BlockColor:
			Rectangle:
				pos: self.pos
				size: self.size
		BoxLayout:
			orientation: 'horizontal'
			size_hint: 1.0, 0.33
			Label:
				id: storage_space_title
				text: "Storage Space"
				text_size: self.size
				size_hint: 0.5, 1.0
				font_size: '14sp'
				bold: True
				color: app.DARK_GREY
			Label:
				id: storage_space_label
				text: main_menu.storage_percent
				size_hint: 0.5, 1.0
				text_size: self.size
				halign: 'right'
				bold: True
				font_size: '14sp'
				color: app.DARK_GREY
		BoxLayout:
			orientation: 'horizontal'
			size_hint: 1.0, 0.33
			Mybar:
				id: storage_bar
				size_hint: 1.0, 1.0
				value: 0

		BoxLayout:
			orientation: 'horizontal'
			size_hint: 1.0, 0.33
			Label:
				id: storage_space_lower_label
				text: main_menu.lower_storage_limit
				text_size: self.size
				valign: 'top'
				size_hint: 0.5, 1.0
				font_size: '12sp'
				color: app.GREY
			Label:
				id: storage_space_upper_label
				text: main_menu.upper_storage_limit
				text_size: self.size
				halign: 'right'
				valign: 'top'
				size_hint: 0.5, 1.0
				font_size: '12sp'
				color: app.GREY

	### Storage information
	BoxLayout:
		orientation: 'horizontal'
		size_hint: 1.0, 0.07
		spacing: 1
		canvas.before:
			Color:
				rgba: 1, 1, 1, 0
			Rectangle:
				pos: self.pos
				size: self.size
		BoxLayout:
			orientation: 'vertical'
			size_hint: 0.33, 1.0
			padding: 0, 10
			canvas.before:
				BlockColor:
				Rectangle:
					pos: self.pos
					size: self.size
			Label:
				id: storage_space_free_title
				text: "FREE"
				font_size: '12sp'
				color: app.GREY
			Label:
				id: storage_space_free_label
				text: main_menu.free_amount
				font_size: '16sp'
				font_name: './fonts/Montserrat-Bold.ttf'
				color: app.DARK_GREY
		BoxLayout:
			orientation: 'vertical'
			size_hint: 0.33, 1.0
			padding: 0, 10
			canvas.before:
				BlockColor:
				Rectangle:
					pos: self.pos
					size: self.size
			Label:
				id: storage_space_used_title
				text: "USED"
				font_size: '12sp'
				color: app.GREY
			Label:
				id: storage_space_used_label
				text: main_menu.used_amount
				font_size: '16sp'
				font_name: './fonts/Montserrat-Bold.ttf'
				color: app.DARK_GREY
		BoxLayout:
			orientation: 'vertical'
			size_hint: 0.33, 1.0
			padding: 0, 10
			canvas.before:
				BlockColor:
				Rectangle:
					pos: self.pos
					size: self.size
			Label:
				id: storage_space_total_title
				text: "TOTAL"
				font_size: '12sp'
				color: app.GREY
			Label:
				id: storage_space_total_label
				text: main_menu.total_amount
				font_size: '16sp'
				font_name: './fonts/Montserrat-Bold.ttf'
				color: app.DARK_GREY


	### Button row
	BoxLayout:
		orientation: 'horizontal'
		size_hint: 1.0, 0.1
		padding: 20, 0
		canvas.before:
			BlockColor:
			Rectangle:
				pos: self.pos
				size: self.size

		spacing: 10
		ActionButton:
			id: settings_btn
			pos_hint: {'center_y': 0.5}
			text: "SETTINGS"
			size: 100, 40
			font_size: '16sp'
			size_hint: 0.5, None
			background_color: app.BLUE
			on_release: main_menu.go_settings()
		ActionButton:
			id: go_btn
			pos_hint: {'center_y': 0.5}
			text: main_menu.go_text
			actual_state: 'normal'
			size: 100, 40
			font_size: '16sp'
			size_hint: 0.5, None
			background_color: app.GREEN
			on_release: main_menu.go_toggle(go_btn)

<SettingsMenu>:
	id: settings_menu
	orientation: 'vertical'
	pos_hint: {'top': 1.0}
	spacing: 1
	canvas.before:
		Color:
			rgba: app.LIGHT_GREY
		Rectangle:
			pos: self.pos
			size: self.size
	Label:
		text: 'Settings'
		size_hint: 1.0, 0.1
		text_size: self.size
		padding: -20, 0
		valign: 'middle'
		font_size: '16sp'
		color: app.GREY
		canvas.before:
			BlockColor:
			Rectangle:
				pos: self.pos
				size: self.size
	BoxLayout:
		orientation: 'vertical'
		padding: 20, 0
		spacing: 5
		size_hint: 1.0, 0.9
		canvas.before:
			BlockColor:
			Rectangle:
				pos: self.pos
				size: self.size
		BoxLayout:
			orientation: 'vertical'
			Label:
				text: 'Node'
				text_size: self.size
				valign: 'middle'
				font_size: '16sp'
				color: app.GREY
				canvas.before:
					BlockColor:
					Rectangle:
						pos: self.pos
						size: self.size
			DropDown:
				Button:
					text: 'hi'
					size_hint_y: None
					height: 22
					canvas.before:
						BlockColor:
						Rectangle:
							pos: self.pos
							size: self.size
		BoxLayout:
			orientation: 'vertical'
			Label:
				text: 'Allocate Space'
				text_size: self.size
				valign: 'middle'
				font_size: '16sp'
				color: app.GREY
				canvas.before:
					BlockColor:
					Rectangle:
						pos: self.pos
						size: self.size
			BoxLayout:
				orientation: 'horizontal'
				canvas.before:
					BlockColor:
					Rectangle:
						pos: self.pos
						size: self.size
				TextInput:
					id: storage_allocation
					size_hint: 0.85, 1
					multiline: False
				Label:
					text: 'GB'
					text_size: self.size
					size_hint: 0.15, 1
					valign: 'middle'
					halign: 'center'
					font_size: '16sp'
					color: app.GREY
		BoxLayout:
			orientation: 'vertical'
			Label:
				text: 'Space Folder'
				text_size: self.size
				valign: 'middle'
				font_size: '16sp'
				color: app.GREY
				canvas.before:
					BlockColor:
					Rectangle:
						pos: self.pos
						size: self.size
			BoxLayout:
				orientation: 'horizontal'

				canvas.before:
					BlockColor:
					Rectangle:
						pos: self.pos
						size: self.size
				TextInput:
					id: storage_allocation
					text: settings_menu.filename
					disabled: True
					size_hint: 0.7, 1.0
					multiline: False
				ActionButton:
					text: 'Browse...'
					size_hint: 0.3, 1.0
					background_color: app.BLUE
					on_release: settings_menu.show_fileselect()

		BoxLayout:
			orientation: 'vertical'
			Label:
				text: 'SJCX Payout Address'
				text_size: self.size
				valign: 'middle'
				font_size: '16sp'
				color: app.GREY
				canvas.before:
					BlockColor:
					Rectangle:
						pos: self.pos
						size: self.size
			TextInput:
				id: payout_address
				multiline: False

		ActionButton:
			id: logs_btn
			text: 'Logs'
			size: 100, 40
			size_hint: 1.0, None
			font_size: '16sp'
			background_color: app.BLUE
			canvas.before:
				BlockColor:
				Rectangle:
					pos: self.pos
					size: self.size
		BoxLayout:
			orientation: 'horizontal'
			spacing: 10
			canvas.before:
				BlockColor:
				Rectangle:
					pos: self.pos
					size: self.size
			ActionButton:
				text: 'CANCEL'
				size: 100, 40
				font_size: '16sp'
				pos_hint: {'center_y': 0.5}
				size_hint: 0.5, None
				background_color: app.RED
				on_release: settings_menu.go_main()
			ActionButton:
				text: 'OK'
				size: 100, 40
				pos_hint: {'center_y': 0.5}
				font_size: '16sp'
				size_hint: 0.5, None
				background_color: app.BLUE
				on_release: settings_menu.save_settings(settings_menu)

<FileSelectDialog>:
	text_input: text_input
	BoxLayout:
		size: root.size
		pos: root.pos
		orientation: "vertical"
		FileChooserListView:
			id: filechooser
			on_selection: text_input.text = self.selection and self.selection[0] or ''

		TextInput:
			id: text_input
			size_hint_y: None
			height: 30
			multiline: False

		BoxLayout:
			size_hint_y: None
			height: 30
			Button:
				text: "Cancel"
				on_release: root.cancel()
			Button:
				text: "Select"
				on_release: root.select(filechooser.path, text_input.text)

<MainScreen>:
	MainMenu:

<SettingsScreen>:
	SettingsMenu:
